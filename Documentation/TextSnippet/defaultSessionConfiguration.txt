NSURLSessionConfiguration*
defaultSessionConfiguration = [NSURLSessionConfiguration defaultSessionConfiguration];

// How long will it wait after the loss of Internet connection - before the emergency completion of the task
// this is the timeout between the closest server portions of data received from
defaultSessionConfiguration.timeoutIntervalForRequest  = 60;

// This is the total time to wait for a response from a resource.
defaultSessionConfiguration.timeoutIntervalForResource = 1000;

defaultSessionConfiguration.URLCache = [[NSURLCache alloc] initWithMemoryCapacity:0 diskCapacity:0 diskPath:nil];
defaultSessionConfiguration.URLCredentialStorage = [NSURLCredentialStorage sharedCredentialStorage];
defaultSessionConfiguration.requestCachePolicy   = NSURLRequestReloadIgnoringLocalCacheData;
defaultSessionConfiguration.discretionary        = YES; // So that the system can expect optimal conditions to perform the transfer, such as when the device is connected to Wi-Fi.

if (@available(macOS 10.13.1, iOS 11, *)) {
    defaultSessionConfiguration.waitsForConnectivity = YES;
}